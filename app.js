(()=>{"use strict";var e={91:e=>{e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),t.hash&&(e+=t.hash),t.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(e)?'"'.concat(e,'"'):e):e}},606:(e,t,r)=>{e.exports=r.p+"img/3a24d1c2d9b22774331d.ico"}},t={};function r(n){var s=t[n];if(void 0!==s)return s.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,r),a.exports}r.m=e,r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;r.g.importScripts&&(e=r.g.location+"");var t=r.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");n.length&&(e=n[n.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=e})(),r.b=document.baseURI||self.location.href,(()=>{var e=r(91),t=r.n(e),n=new URL(r(606),r.b);function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}t()(n);var i=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.container=null,this.listsTitles=["TODO","In Progress","Done"],this.selectedItem=null,this.selectedItemRect=null,this.draggedItem=null,this.startX=0,this.startY=0,this.storage=window.localStorage}var t,r;return t=e,r=[{key:"bindToDOM",value:function(e){if(!(e instanceof HTMLElement))throw new Error("container is not HTMLElement");this.container=e}},{key:"checkBinding",value:function(){if(null===this.container)throw new Error("Class is not bind to DOM")}},{key:"addEventListeners",value:function(){var e=this;document.addEventListener("mousedown",(function(t){return e.dragCard(t)})),document.addEventListener("mousemove",(function(t){return e.moveCard(t)})),document.addEventListener("mouseup",(function(t){return e.dropCard(t)}))}},{key:"init",value:function(){this.checkBinding(),this.addEventListeners(),null!==this.storage.getItem("boardLists")?this.loadFromLocalStorage():this.drawTest()}},{key:"drawTest",value:function(){var e=this;this.listsTitles.forEach((function(t){e.createListWrapper(t)}))}},{key:"createListWrapper",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=document.createElement("div");n.classList.add("list-wrapper");var s=r||"board".concat(this.getRandomInt());n.innerHTML='<div class="list" data-board-id="'.concat(s,'">\n            <div class="list-header">').concat(e,'</div>\n            <div class="list-cards">              \n            </div>\n            <div class="card-composer-container">\n              <a class="open-card-composer" href="#">\n                <span><svg aria-hidden="true" focusable="false" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="svg-icon icon-add"><path fill="currentColor" d="M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z" class=""></path></svg></span>\n                <span class="js-add-a-card">Добавить карточку</span>\n              </a>\n            </div>\n          </div>'),n.querySelector(".open-card-composer").addEventListener("click",(function(e){return t.openCardComposer(e)})),this.container.appendChild(n)}},{key:"openCardComposer",value:function(e){var t=this,r=e.target.closest(".list"),n=r.querySelector(".list-cards"),s=r.querySelector(".card-composer-container"),a=document.createElement("div");a.classList.add("card-composer"),a.innerHTML='<div class="list-card-composer">\n          <div class="list-card-details">\n            <textarea class="list-card-composer-textarea" placeholder="Ввести заголовок для этой карточки"></textarea>\n          </div>\n        </div>\n        <div class="cc-controls">\n          <div class="cc-controls-section">\n            <button class="confirm" type="button">Добавить карточку</button>\n            <a class="icon-close" href="#"></a>\n          </div>\n        </div>',s.style.display="none",a.querySelector(".icon-close").addEventListener("click",(function(e){return t.closeCardComposer(e)})),n.appendChild(a);var o=a.querySelector(".list-card-composer-textarea");a.querySelector(".confirm").addEventListener("click",(function(e){o.value.match(/[^\s]/g)&&(t.createCard(r.dataset.boardId,o.value),a.remove(),s.style.display="block")})),o.addEventListener("keypress",(function(e){o.value.match(/[^\s]/g)&&13===e.keyCode&&!e.shiftKey&&(t.createCard(r.dataset.boardId,o.value),a.remove(),s.style.display="block")}))}},{key:"closeCardComposer",value:function(e){var t=e.target.closest(".list"),r=t.querySelector(".card-composer"),n=t.querySelector(".card-composer-container");r.remove(),n.style.display="block"}},{key:"createCard",value:function(e,t){var r=this,n=this.container.querySelector('[data-board-id="'.concat(e,'"]')).querySelector(".list-cards"),s=document.createElement("div");s.classList.add("list-card"),s.innerHTML='<div class="list-card-details"><div class="text">'.concat(t,'</div> <span class="icon-close"></span>'),s.querySelector(".icon-close").addEventListener("click",(function(e){return r.deleteConfirmation(e)})),n.appendChild(s),this.saveToLocalStorage()}},{key:"deleteConfirmation",value:function(e){var t=this,r=e.target.closest(".list-card"),n=document.createElement("div");n.classList.add("popover"),n.innerHTML='Уверены? <a href="#" class="popover_confirm">Да</a> <a href="#" class="popover_cancel">Нет</a>',n.querySelector(".popover_confirm").addEventListener("click",(function(e){return t.deleteCard(r)})),n.querySelector(".popover_cancel").addEventListener("click",(function(){return n.remove()})),r.appendChild(n)}},{key:"deleteCard",value:function(e){e.remove(),this.saveToLocalStorage()}},{key:"dragCard",value:function(e){if(!(e.target.classList.contains("icon-close")||e.target.classList.contains("popover_confirm")||e.target.classList.contains("popover_cancel"))){var t=e.target.closest(".list-card");if(t){this.selectedItem=t,this.draggedItem=this.selectedItem.cloneNode(!0),this.draggedItem.classList.add("card-cloned"),this.selectedItem.classList.add("card-selected");var r=this.selectedItem.clientWidth,n=this.selectedItem.clientHeight;this.selectedItemRect=this.selectedItem.getBoundingClientRect();var s=document.body,a=s.scrollLeft,o=s.scrollTop,i=this.selectedItemRect.left+a,c=this.selectedItemRect.top+o;this.startX=e.clientX,this.startY=e.clientY,this.draggedItem.style.width="".concat(r,"px"),this.draggedItem.style.height="".concat(n,"px"),this.draggedItem.style.top="".concat(c,"px"),this.draggedItem.style.left="".concat(i,"px"),document.body.appendChild(this.draggedItem)}}}},{key:"moveCard",value:function(e){if(e.preventDefault(),this.selectedItem){var t=e.clientX,r=e.clientY,n=document.body,s=n.scrollLeft,a=n.scrollTop,o=this.selectedItemRect.left+s+t-this.startX,i=this.selectedItemRect.top+a+r-this.startY,c=document.elementFromPoint(o+10,i-1),l=c.closest(".list-card"),d=c.closest(".list-header");if(l&&l!==this.selectedItem){var u=l.getBoundingClientRect(),h=l.closest(".list-cards");r-20===u.y?h.insertBefore(this.selectedItem,l):r-20<u.y&&h.insertBefore(this.selectedItem,l.nextSibling)}else!l&&d&&l!==this.selectedItem&&d.closest(".list-wrapper").querySelector(".list-cards").prepend(this.selectedItem);this.draggedItem.style.top="".concat(i,"px"),this.draggedItem.style.left="".concat(o,"px")}}},{key:"dropCard",value:function(e){if(this.selectedItem){var t=e.clientX,r=e.clientY;this.draggedItem.style.display="none";var n=document.elementFromPoint(t,r);if(n.closest(".list"))if(n.closest(".list-card")){var s=n.closest(".list-card"),a=s.closest(".list-cards");a&&s&&(null!==s.nextSibling?a.insertBefore(this.selectedItem,s):a.insertBefore(this.selectedItem,s.nextSibling))}else n.closest(".list").querySelector(".list-cards").appendChild(this.selectedItem);this.selectedItem.classList.remove("card-selected"),this.selectedItem=null,this.draggedItem.remove(),this.draggedItem=null,this.saveToLocalStorage()}}},{key:"saveToLocalStorage",value:function(){var e=a(this.container.querySelectorAll(".list")).map((function(e){return{id:e.dataset.boardId,name:e.querySelector(".list-header").innerHTML,cards:a(e.querySelectorAll(".list-card")).filter((function(e){return e.innerText.length>0})).map((function(e){return e.innerText}))}}));this.storage.setItem("boardLists",JSON.stringify(e))}},{key:"getRandomInt",value:function(){return Math.floor(1e3+99999*Math.random())}},{key:"loadFromLocalStorage",value:function(){var e=this;JSON.parse(this.storage.getItem("boardLists")).forEach((function(t){e.createListWrapper(t.name,t.id),t.cards.forEach((function(r){return e.createCard(t.id,r)}))}))}}],r&&o(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}());i.bindToDOM(document.querySelector("#board")),i.init()})()})();
//# sourceMappingURL=app.js.map